1. Выяснение требований:

* Персонализированная лента новостей служит для того, чтобы поддерживать уровень вовлеченности пользователей на платформе
* В постах содержится: текст, изображения, видео и любая их комбинация
* Самый привлекательный контент размещаем в начале ленты
* Оптимизируем модель под целевую метрику ( выбираем на свое усмотрение лайк/репост/комментарий/клик )
* Есть несколько видов взаимодействия: кликать, лайкать, делиться контентом, комментировать, скрывать контент, блокировать других пользователей и отправлять заявки в друзья.
* Система должна выводить ранжированные посты менее, чем за 200 миллисекунд.
* Три миллиарда пользователей, два из которых активные ( проверяют ленту более 2х раз в день )

Резюмирую требования:

Требуется спроектировать систему персонализации ленты новостей. Система получает посты, которые пользователь ранее не просматривал, а также посты с непросмотренными комментариями, и ранжирует их на основании того, насколько они способствуют вовлеченности пользователя. Получение результата должно занимать не более 200 миллисекунд. Цель системы — повысить вовлеченность пользователей.

2. Формулировка проблемы в виде задачи МО

* Три возможные цели МО: 
 - максимизировать количество тех или иных неявных реакций — например, времени пребывания или кликов: В этом случае неявные сигналы интерпретируются как опосредованные свидетельства вовлеченности пользователя. Например, можно оптимизировать систему МО так, чтобы максимизировать количество кликов. Преимущество этого варианта заключается в том, что о неявных реакциях доступно больше данных, чем о явных. А чем больше обучающих данных, тем обычно точнее модель. К недостаткам относится то, что неявные реакции не всегда отражают настоящее отношение пользователей к посту. Например, пользователь может щелкнуть по посту и обнаружить, что его не хочется читать.
 - максимизировать количество тех или иных явных реакций — например, лайков или репостов: В этом случае отношение пользователей к посту оценивается по явным реакциям. Преимущество такого подхода в том, что явные сигналы обычно более весомы, чем неявные. Например, если посту поставили лайк — это более сильный сигнал вовлеченности, чем простой клик. Главный недостаток в том, что лишь небольшое число пользователей выражает свое отношение явными реакциями. Например, пользователь может посчитать пост интересным, но не отреагировать на него. В такой ситуации модели трудно сделать точное предсказание из-за того, что обучающие данные ограниченны.
 - максимизировать взвешенную оценку, основанную как на неявных, так и на явных реакциях: В этом случае, чтобы узнать отношение пользователя к посту, используются как неявные, так и явные реакции. При этом каждой реакции назначается вес в зависимости от того, какую ценность для нас она представляет. Затем система МО оптимизируется, чтобы максимизировать взвешенную оценку реакций. Здесь мы задаем веса каждому виду отклика и от этого оптимизируем свою модель. Мы можем задавать весь каждому действию в зависимости от потребности бизнеса.

* Определение входных и выходных данных: персонализированная лента новостей принимает на вход данные о пользователе, а на выходе возвращает ранжированный список непросмотренных постов, а также постов с непросмотренными комментариями, отсортированный по показателю вовлеченности.

3. Подготовка данных

* Доступны следующие данные: пользователи, посты, взаимодействия пользователей с постами, дружеские отношения
* Пользователь хранит информацию о: ID пользователя, Имя пользователя, Возраст, Пол, Город, Страна, Язык, Часовой пояс
* Посты хранят информацию о: ID автора, Текстовое содержимое, Хештеги, Упоминаниня, Изображения или видео, Временная метка
* Взаимодействия пользователей с постами хранят информацию о: ID пользователя, ID поста, Тип взаимодействия, Значение взаимодействия, Геопозиция, Временная метка
* Дружеские отношения хранят информацию о: ID пользователя 1, ID пользователя 2, Временная метка формирования связи, Является ли близким другом, Является ли членом семьи.

* Конструирование признаков: будут сконструированы признаки в следующих категориях: посты, пользователи, связи между пользователями
 - Признаки постов: текстовое содержимое, изображения или видео, реакции, хештеги, возраст поста.
 - Признаки пользователей: демографические признаки: возраст, пол, страна и т. д.; контекстная информация: устройство, время суток и т. д.; история взаимодействий пользователя с постами; упоминания в постах.
 - Связи между пользователями и авторами: Частота лайков (кликов, комментариев, репостов); Продолжительность дружбы; Близкие друзья и семья.

4. Разработка модели

Выбираю архитектуру нейронная сеть, так как позволяет работать с различными видами фичей и работать с нелинейными данными. Нужно выбрать что использовать: общая нейронная сеть для всех данных, или несколько независимых.
В случае с несколькими нейронными сетями нужно слишком много данных на обучение и такую структуру тяжело поддержививать. В случае с одной общей нейросетью и головой классификатором под каждую задачу этой проблемы удастся избежать.

Для борьбы с пассивными пользователями можно добавить две неявные реакции: Пропуск поста ( пост открыт менее секунды ), Время пребывания ( сколько был открыт пост )

* Функци потерь: кроссэнтропия

5. Оценка

* Оффлайн метрики: ROC-AUC
* Онлайн метрики: CTR; частота реакций; общее количество проведенного времени; удовлетворенность пользователей по результатам опросов.

6. Эксплуатация

Предсказательный пайплайн: сервис выборки, сервис ранжирования и сервис повторного ранжирования.

- Сервис выборки: Этот компонент загружает посты, которые пользователь еще не просматривал, а также посты с новыми комментариями.
- Сервис ранжирования: Этот компонент ранжирует загруженные посты, присваивая каждому из них оценку вовлеченности.
- Сервис повторного ранжирования: Этот компонент модифицирует список постов в соответствии с дополнительной логикой и пользовательскими фильтрами. Например, если пользователь явно выразил свой интерес к определенной теме (скажем, футболу), то сервис назначает соответствующим постам более высокий ранг.
