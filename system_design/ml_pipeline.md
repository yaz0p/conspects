При постановке задачи нужно разбить её на несколько этапов, чтобы последовательно прийти к цели. 
Последовательность этапов:
1. Пояснение проблемы
2. Формулировка проблемы как задачи машинного обучения
3. Подготовка данных
4. Разработка модели
5. Оценка
6. Развертывание и эксплуатация
7. Мониторинг и инфраструктура

Теперь пройдусь по каждому пункту:
1. Уточнить *бизнес-цель*, *функционал, поддерживаемый системой*, *данные*, *ограничения*, *масштаб системы*, *производительность*.
2. Нужно уточнить задачу и нужно ли машинное обучение (МО) для решения этой задачи? Нужно: опеределить цель МО, определить входные и выходные данные системы, выбрать подходящую категорию МО.
* Определить цель МО

| Приложение                              | Бизнес-цель                          | Цель МО                                      |
|-----------------------------------------|--------------------------------------|----------------------------------------------|
| Приложение для продажи билетов на мероприятия | Повысить продажи билетов            | Максимизировать количество регистраций на мероприятия |
| Видеостриминговое приложение            | Повысить степень вовлеченности пользователей | Максимизировать время, которое пользователи проводят за просмотром видео |
| Система прогнозирования кликов по рекламе | Увеличить количество кликов          | Максимизировать CTR (кликабельность)         |
| Выявление вредоносного контента в социальной сети | Сделать платформу безопаснее        | Точно предсказывать, является ли контент вредоносным |
| Система рекомендации друзей             | Увеличить темп расширения сети пользователя | Максимизировать количество установленных связей |

* Определить входные и выходные данные системы

Например, для системы выявления вредоносного контента в социальной сети входными данными является пост, а выходными — решение о том, считать ли его вредоносным.
Иногда система может состоять более чем из одной модели МО. 
В таком случае требуется определить входные и выходные данные для каждой модели. На пример, в примере с выявлением вредоносного контента одна модель может выявлять призыв к насилию, а другая — непристойные изображения. 
Система опирается на обе эти модели, чтобы решить, считать ли пост вредоносным.
Так же можно по разному определять входные и выходные данные модели, и это стоит учитывать.

* Выбор подходящей модели
Для каждой задачи существует какая-то категория алгоритмов машинного обучения. Выбирать нужно по обстоятельствам.

3. Подготовка данных
Для моделей машинного обучения нужны хорошие данные. Нужно настроить пайплайн для сбора,
хранения, извлечения и обработки данных.
 * Источники данных
Система МО может работать с данными из многих источников. Полезно разбираться в источниках данных, чтобы отвечать на различные контекстные
вопросы, например: кто собирал данные? Насколько они чисты? Можно лидоверять источнику? Данные созданы пользователями или сгенерированы машиной?
 * Хранилище данных
Нужно грамотно выбрать базу данных для конкретных задач. Обычно все сводится к PostgreSQL, Clickhouse, Redis и QDrant.
 * ETL
Процедура ETL (Extract, Transform, Load — «извлечение, преобразование, загрузка») состоит из трех фаз: извлечение, преобразование, загрузка
 * Определиться с типами данных

 | Категория               | Структурированные данные                                                                 | Неструктурированные данные                                                                 |
|-------------------------|------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|
| **Характеристики**       | Заранее определенная схема.<br>Просто выполнять поиск                                      | Нет определенной схемы.<br>Трудно выполнять поиск                                           |
| **Место хранения**       | Реляционные базы данных.<br>Во многих базах данных NoSQL могут храниться структурированные данные | Базы данных NoSQL.<br>Озера данных                                                          |
| **Примеры**              | Даты.<br>Телефонные номера.<br>Номера кредитных карт.<br>Адреса.<br>Имена                | Текстовые файлы.<br>Аудиофайлы.<br>Изображения.<br>Видео                                   |

4. Разработка модели

* Выбор модели
 * Создать простое базовое решение (baseline)
 * Поэкспериментировать с простыми моделями
 * Перейти на более сложные модели
 * Использовать ансамбли моделей, если нужны более точные предсказания

* Обучение модели

 * Построение датасета
  * Сбор необработанных данных
  * Выявление признаков и меток
  * Выбор стратегии формирования выборки
  * Разбиение данных
  * Решение проблем несбалансированности классов (генерация/обрезание данных | взвешивание классов)
 * Выбор функции потерь
 * Обучение с нуля или использование готового или finetuned предобученной модели

5. Оценка
* Автономная (offline) оценка
| Задача                              | Автономные метрики                                                                                                                                                                                                 |
|-------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Классификация**                   | Точность (precision), полнота (recall), F₁-мера<br>Доля верных результатов (accuracy)<br>ROC-AUC, PR-AUC<br>Матрица ошибок                                                                                         |
| **Регрессия**                       | MSE, MAE, RMSE                                                                                                                                                                                                     |
| **Ранжирование**                    | Точность на k элементах (precision@k)<br>Полнота на k элементах (recall@k)<br>Среднеобратный ранг (MRR)<br>mAP (mean Average Precision)<br>nDCG (Normalized Discounted Cumulative Gain)                            |
| **Генерирование изображений**       | Расстояние Фреше (FID) <br>«Мера внедрения» (Inception Score)                                                                                                                                              |
| **Обработка естественного языка**   | BLEU <br>METEOR <br>ROUGE <br>CIDEr <br>SPICE                                                                                                                                                  |


* Оперативная (online) оценка

| Задача                              | Оперативные метрики                                                                         |
|-------------------------------------|---------------------------------------------------------------------------------------------|
| **Предсказание кликов на рекламе**  | Кликабельность (CTR)<br>Повышение выручки и т. д.                                           |
| **Выявление вредоносного контента** | Степень распространения<br>Количество обжалований и т. д.                                   |
| **Рекомендации видео**              | Кликабельность (CTR)<br>Общее время просмотра<br>Количество завершенных просмотров и т. д.  |
| **Рекомендации друзей**             | Количество запросов, отправляемых и принимаемых за день и т. д.                            |

6. Развертывание и эксплуатация

* развертывание в облаке или на устройстве;
* сжатие модели (дистиляция, прунинг, квантование);
* тестирование в режиме эксплуатации;
* пайплайн предсказаний.

7. Мониторинг

* Почему в действующей системе происходят сбои;
* Какие показатели следует отслеживать.

